##
# Grab CISA Known Vulnerabilities and show recent ones.
# 
# See:  https://www.cisa.gov/known-exploited-vulnerabilities-catalog
#
# A simple helper by Jemurai.
#
echo "Grabbing cisa json"
curl https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json > cisa.json

# Subtract 2 weeks from current day.
DAT=$(date -v-14d +%Y-%m-%d)
echo "DAT is " $DAT
cat cisa.json | jq '.vulnerabilities[] | .dateAdded + " " + .vulnerabilityName' > cisa.1.txt
sed 's/\"//g' cisa.1.txt > cisa.2.txt
awk -v DAT="$DAT" ' $1 >= DAT ' cisa.2.txt > cisa.3.txt
cat cisa.3.txt

rm cisa.1.txt
rm cisa.2.txt
rm cisa.3.txt
